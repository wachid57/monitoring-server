import{r as a,j as e,B as f,A as x,z as j,C as w}from"./index-CJWZi9CB.js";import{D as X,X as J,_ as U,b as Y,z as Z}from"./index.esm-CBP19pFL.js";import{P as q}from"./PageContainer-BR_WMDrZ.js";import{B as Q}from"./Breadcrumb-DR6zDa-i.js";import{C as V}from"./Card-BdzGKbvD.js";import{C as ee}from"./CardContent-B4ITIunY.js";import{S as z}from"./Stack-C8hAk-Ua.js";import{B}from"./Box-B21Vn3Wr.js";import{T as c}from"./TextField-ZPSYDyyk.js";import{I as te}from"./InputAdornment-DP5E7Axe.js";import{B as d}from"./Button-BH1WbAiu.js";import{A as re}from"./Alert-NqiMgJWO.js";import{C as F}from"./CircularProgress-DjzG6_YG.js";import{T as se}from"./TableContainer-C29JBPns.js";import{P as oe}from"./Paper-Dk0UhltF.js";import{T as ae,d as ie,b,c as s,a as ne}from"./TableRow-BlqcCBcb.js";import{I as T}from"./IconButton-Cf6Oa_Gi.js";import{a as I,b as P}from"./DialogContent-iZlfiihu.js";import{D as $}from"./DialogTitle-fL9kXoX8.js";import{T as le}from"./Typography-DW8TAfFy.js";import{D as H}from"./DialogActions-WyzZcgZE.js";import"./Grid2-TKUllLdh.js";import"./composeClasses-CkcSq-l_.js";import"./index-BwqtTtay.js";import"./useSlotProps-Dmx4i6VU.js";import"./Link-DrUusogV.js";import"./createStack-B05ZxkoV.js";import"./useSlot-BJnJs1tW.js";import"./FormControl-CoJ51_a0.js";import"./utils-DoM3o7-Q.js";import"./useFormControl-D8zMB56u.js";import"./isMuiElement-DUOjtQlD.js";import"./useId-5Do1p0JB.js";import"./formControlState-Dq1zat_P.js";import"./Select-BdS4d3Pw.js";import"./Popover-C4QiusQk.js";import"./isHostComponent-DVu5iVWx.js";import"./Modal-BmV9fUd8.js";import"./getReactNodeRef-CxaND9dZ.js";import"./ownerWindow-CPegdbNg.js";import"./createChainedFunction-BO_9K8Jh.js";import"./utils-C-EoFTAL.js";import"./Portal-BXG2mGLy.js";import"./debounce-Be36O1Ab.js";import"./Grow-rhCcvyQJ.js";import"./List-CPHbMiuQ.js";import"./useControlled-Cuh16IWT.js";import"./resolveProps-CxWqPvcr.js";import"./Close-4pq8Nglm.js";const pe=[{to:"/",title:"Home"},{title:"Host Groups"},{title:"List Host Groups"}],at=()=>{var E;const[W,k]=a.useState([]),[N,D]=a.useState(!1),[S,n]=a.useState(""),[m,O]=a.useState(""),[C,h]=a.useState({open:!1,group:null}),[R,p]=a.useState(!1),[o,l]=a.useState({group_name:"",alias:"",groups_tags:"",keterangan:""}),[u,_]=a.useState(!1),[G,y]=a.useState(null),[K,A]=a.useState(!1),L=async()=>{D(!0),n("");try{const t=await fetch(`${f}${x}/infrastructure/hosts/groups`,{headers:j()});if(t.status===401||t.status===403){w({status:t.status});return}const r=await t.json();t.ok?k(r||[]):n(r.error||"Failed to fetch host groups")}catch(t){console.error("fetch groups error",t),n("Failed to fetch host groups")}finally{D(!1)}},M=async t=>{try{const r=await fetch(`${f}${x}/hosts/groups/${t}`,{method:"DELETE",headers:j()});if(r.status===401||r.status===403)return w({status:r.status});if(r.ok)k(i=>i.filter(g=>g.id!==t)),h({open:!1,group:null});else{const i=await r.json();n(i.error||"Failed to delete host group")}}catch(r){console.error("delete group error",r),n("Failed to delete host group")}},v=W.filter(t=>{var r,i,g;return((r=t.group_name)==null?void 0:r.toLowerCase().includes(m.toLowerCase()))||((i=t.alias)==null?void 0:i.toLowerCase().includes(m.toLowerCase()))||((g=t.keterangan)==null?void 0:g.toLowerCase().includes(m.toLowerCase()))});return a.useEffect(()=>{L()},[]),e.jsxs(q,{title:"List Host Groups",description:"Manage host groups",children:[e.jsx(Q,{title:"List Host Groups",items:pe}),e.jsx(V,{children:e.jsxs(ee,{children:[e.jsxs(z,{direction:"row",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsx(B,{sx:{minWidth:300},children:e.jsx(c,{placeholder:"Search group...",value:m,onChange:t=>O(t.target.value),InputProps:{startAdornment:e.jsx(te,{position:"start",children:e.jsx(X,{size:20})})},fullWidth:!0})}),e.jsx(d,{variant:"contained",startIcon:e.jsx(J,{}),onClick:()=>p(!0),sx:{width:225},children:"Add Group"})]}),S&&e.jsx(re,{severity:"error",sx:{mb:3},children:S}),N?e.jsx(B,{display:"flex",justifyContent:"center",py:4,children:e.jsx(F,{})}):e.jsx(se,{component:oe,children:e.jsxs(ae,{children:[e.jsx(ie,{children:e.jsxs(b,{children:[e.jsx(s,{children:"Group Name"}),e.jsx(s,{children:"Alias"}),e.jsx(s,{children:"Tags"}),e.jsx(s,{children:"Keterangan"}),e.jsx(s,{children:"Created"}),e.jsx(s,{align:"center",children:"Actions"})]})}),e.jsx(ne,{children:v.length===0?e.jsx(b,{children:e.jsx(s,{colSpan:7,align:"center",children:"No host groups found"})}):v.map(t=>e.jsxs(b,{children:[e.jsx(s,{children:t.group_name||"-"}),e.jsx(s,{children:t.alias||"-"}),e.jsx(s,{children:t.groups_tags||"-"}),e.jsx(s,{children:t.keterangan||"-"}),e.jsx(s,{children:t.created_at?new Date(t.created_at).toLocaleDateString():"-"}),e.jsx(s,{align:"center",children:e.jsxs(z,{direction:"row",spacing:1,justifyContent:"center",children:[e.jsx(T,{size:"small",color:"primary",children:e.jsx(U,{size:16})}),e.jsx(T,{size:"small",color:"warning",onClick:()=>{_(!0),y(t.id),l({group_name:t.group_name||"",alias:t.alias||"",host_id:t.host_id||"",groups_tags:t.groups_tags||"",keterangan:t.keterangan||""}),p(!0)},children:e.jsx(Y,{size:16})}),e.jsx(T,{size:"small",color:"error",onClick:()=>h({open:!0,group:t}),children:e.jsx(Z,{size:16})})]})})]},t.id))})]})})]})}),e.jsxs(I,{open:C.open,onClose:()=>h({open:!1,group:null}),children:[e.jsx($,{children:"Confirm Delete"}),e.jsx(P,{children:e.jsxs(le,{children:['Delete group "',(E=C.group)==null?void 0:E.group_name,'"?']})}),e.jsxs(H,{children:[e.jsx(d,{onClick:()=>h({open:!1,group:null}),children:"Cancel"}),e.jsx(d,{color:"error",variant:"contained",onClick:()=>{var t;return M((t=C.group)==null?void 0:t.id)},children:"Delete"})]})]}),e.jsxs(I,{open:R,onClose:()=>{p(!1),_(!1),y(null)},fullWidth:!0,maxWidth:"sm",children:[e.jsx($,{children:u?"Edit Group":"Add Group"}),e.jsxs(P,{children:[e.jsx(c,{label:"Group Name",fullWidth:!0,margin:"dense",value:o.group_name,onChange:t=>l({...o,group_name:t.target.value})}),e.jsx(c,{label:"Alias",fullWidth:!0,margin:"dense",value:o.alias,onChange:t=>l({...o,alias:t.target.value})}),e.jsx(c,{label:"Groups Tags",fullWidth:!0,margin:"dense",value:o.groups_tags,onChange:t=>l({...o,groups_tags:t.target.value})}),e.jsx(c,{label:"Keterangan",fullWidth:!0,margin:"dense",multiline:!0,minRows:2,value:o.keterangan,onChange:t=>l({...o,keterangan:t.target.value})})]}),e.jsxs(H,{children:[e.jsx(d,{onClick:()=>p(!1),children:"Cancel"}),e.jsx(d,{variant:"contained",color:"primary",onClick:async()=>{A(!0);try{let t;const r={group_name:o.group_name,alias:o.alias,groups_tags:o.groups_tags,keterangan:o.keterangan};if(u&&G?t=await fetch(`${f}${x}/hosts/groups/${G}`,{method:"PUT",headers:{"Content-Type":"application/json",...j()},body:JSON.stringify(r)}):t=await fetch(`${f}${x}/hosts/groups`,{method:"POST",headers:{"Content-Type":"application/json",...j()},body:JSON.stringify(r)}),t.status===401||t.status===403)return w({status:t.status});const i=await t.json();t.ok?(L(),p(!1),l({group_name:"",alias:"",host_id:"",groups_tags:"",keterangan:""}),_(!1),y(null)):n(i.error||(u?"Failed to update group":"Failed to create group"))}catch(t){console.error(t),n(u?"Failed to update group":"Failed to create group")}finally{A(!1)}},children:K?e.jsx(F,{size:20}):u?"Save":"Create"})]})]})]})};export{at as default};
