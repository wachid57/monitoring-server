import{r as n,j as t,B as g,A as x,z as j,C}from"./index-CJWZi9CB.js";import{D as R,X as M,b as O,z as U}from"./index.esm-CBP19pFL.js";import{P as X}from"./PageContainer-BR_WMDrZ.js";import{B as w}from"./Breadcrumb-DR6zDa-i.js";import{C as K}from"./Card-BdzGKbvD.js";import{C as Y}from"./CardContent-B4ITIunY.js";import{S as L}from"./Stack-C8hAk-Ua.js";import{B as k}from"./Box-B21Vn3Wr.js";import{T as l}from"./TextField-ZPSYDyyk.js";import{I as _}from"./InputAdornment-DP5E7Axe.js";import{B as b}from"./Button-BH1WbAiu.js";import{A as q}from"./Alert-NqiMgJWO.js";import{C as P}from"./CircularProgress-DjzG6_YG.js";import{T as J}from"./TableContainer-C29JBPns.js";import{P as Q}from"./Paper-Dk0UhltF.js";import{T as V,d as Z,b as v,c as s,a as tt}from"./TableRow-BlqcCBcb.js";import{I as W}from"./IconButton-Cf6Oa_Gi.js";import{a as et,b as st}from"./DialogContent-iZlfiihu.js";import{D as it}from"./DialogTitle-fL9kXoX8.js";import{F as rt}from"./FormControlLabel-gVATSXRg.js";import{S as at}from"./Switch-Cw-9Ykbp.js";import{D as ot}from"./DialogActions-WyzZcgZE.js";import"./Grid2-TKUllLdh.js";import"./Typography-DW8TAfFy.js";import"./composeClasses-CkcSq-l_.js";import"./index-BwqtTtay.js";import"./useSlotProps-Dmx4i6VU.js";import"./Link-DrUusogV.js";import"./createStack-B05ZxkoV.js";import"./useSlot-BJnJs1tW.js";import"./FormControl-CoJ51_a0.js";import"./utils-DoM3o7-Q.js";import"./useFormControl-D8zMB56u.js";import"./isMuiElement-DUOjtQlD.js";import"./useId-5Do1p0JB.js";import"./formControlState-Dq1zat_P.js";import"./Select-BdS4d3Pw.js";import"./Popover-C4QiusQk.js";import"./isHostComponent-DVu5iVWx.js";import"./Modal-BmV9fUd8.js";import"./getReactNodeRef-CxaND9dZ.js";import"./ownerWindow-CPegdbNg.js";import"./createChainedFunction-BO_9K8Jh.js";import"./utils-C-EoFTAL.js";import"./Portal-BXG2mGLy.js";import"./debounce-Be36O1Ab.js";import"./Grow-rhCcvyQJ.js";import"./List-CPHbMiuQ.js";import"./useControlled-Cuh16IWT.js";import"./resolveProps-CxWqPvcr.js";import"./Close-4pq8Nglm.js";import"./SwitchBase-D_lOZTBK.js";const nt=[{to:"/",title:"Home"},{title:"Host Groups"},{title:"Bindings"}],S={name:"",alias:"",groupid:"",hostid:"",tags:"",description:"",enabled:!0};function oe(){const[y,B]=n.useState([]),[$,D]=n.useState(!1),[I,d]=n.useState(""),[c,z]=n.useState(""),[F,u]=n.useState(!1),[p,f]=n.useState(null),[i,a]=n.useState(S),[H,T]=n.useState(!1),A=async()=>{D(!0),d("");try{const e=await fetch(`${g}${x}/infrastructure/hosts/groups/bindings`,{headers:j()});if(e.status===401||e.status===403)return C({status:e.status});const r=await e.json();e.ok?B(r||[]):d(r.error||"Failed to fetch")}catch{d("Failed to fetch")}finally{D(!1)}};n.useEffect(()=>{A()},[]);const E=n.useMemo(()=>y.filter(e=>{var r,m,o,h;return((r=e.name)==null?void 0:r.toLowerCase().includes(c.toLowerCase()))||((m=e.alias)==null?void 0:m.toLowerCase().includes(c.toLowerCase()))||((o=e.tags)==null?void 0:o.toLowerCase().includes(c.toLowerCase()))||((h=e.description)==null?void 0:h.toLowerCase().includes(c.toLowerCase()))}),[y,c]),N=async()=>{T(!0),d("");try{const e={...i,groupid:i.groupid?Number(i.groupid):null,hostid:i.hostid?Number(i.hostid):null},r=p?`${g}${x}/infrastructure/hosts/groups/bindings/${p}`:`${g}${x}/infrastructure/hosts/groups/bindings`,o=await fetch(r,{method:p?"PUT":"POST",headers:{"Content-Type":"application/json",...j()},body:JSON.stringify(e)});if(o.status===401||o.status===403)return C({status:o.status});const h=await o.json();o.ok?(u(!1),a(S),f(null),A()):d(h.error||"Failed to save")}catch{d("Failed to save")}finally{T(!1)}},G=async e=>{try{const r=await fetch(`${g}${x}/infrastructure/hosts/groups/bindings/${e}`,{method:"DELETE",headers:j()});if(r.status===401||r.status===403)return C({status:r.status});r.ok&&B(m=>m.filter(o=>o.id!==e))}catch{}};return t.jsxs(X,{title:"Host Group Bindings",description:"Manage host group bindings",children:[t.jsx(w,{title:"Host Group Bindings",items:nt}),t.jsx(K,{children:t.jsxs(Y,{children:[t.jsxs(L,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:3,children:[t.jsx(k,{sx:{minWidth:300},children:t.jsx(l,{fullWidth:!0,placeholder:"Search",value:c,onChange:e=>z(e.target.value),InputProps:{startAdornment:t.jsx(_,{position:"start",children:t.jsx(R,{size:20})})}})}),t.jsx(b,{variant:"contained",startIcon:t.jsx(M,{}),onClick:()=>{a(S),f(null),u(!0)},sx:{width:225},children:"Add Binding"})]}),I&&t.jsx(q,{severity:"error",sx:{mb:2},children:I}),$?t.jsx(k,{display:"flex",justifyContent:"center",py:4,children:t.jsx(P,{})}):t.jsx(J,{component:Q,children:t.jsxs(V,{children:[t.jsx(Z,{children:t.jsxs(v,{children:[t.jsx(s,{children:"Name"}),t.jsx(s,{children:"Alias"}),t.jsx(s,{children:"Group ID"}),t.jsx(s,{children:"Host ID"}),t.jsx(s,{children:"Tags"}),t.jsx(s,{children:"Description"}),t.jsx(s,{children:"Enabled"}),t.jsx(s,{children:"Created"}),t.jsx(s,{children:"Updated"}),t.jsx(s,{align:"center",children:"Actions"})]})}),t.jsx(tt,{children:E.length===0?t.jsx(v,{children:t.jsx(s,{colSpan:10,align:"center",children:"No data"})}):E.map(e=>t.jsxs(v,{children:[t.jsx(s,{children:e.name||"-"}),t.jsx(s,{children:e.alias||"-"}),t.jsx(s,{children:e.groupid??"-"}),t.jsx(s,{children:e.hostid??"-"}),t.jsx(s,{children:e.tags||"-"}),t.jsx(s,{children:e.description||"-"}),t.jsx(s,{children:e.enabled?"Yes":"No"}),t.jsx(s,{children:e.created?new Date(e.created).toLocaleString():"-"}),t.jsx(s,{children:e.updated?new Date(e.updated).toLocaleString():"-"}),t.jsxs(s,{align:"center",children:[t.jsx(W,{color:"warning",size:"small",onClick:()=>{f(e.id),a({name:e.name||"",alias:e.alias||"",groupid:e.groupid||"",hostid:e.hostid||"",tags:e.tags||"",description:e.description||"",enabled:!!e.enabled}),u(!0)},children:t.jsx(O,{size:16})}),t.jsx(W,{color:"error",size:"small",onClick:()=>G(e.id),children:t.jsx(U,{size:16})})]})]},e.id))})]})}),t.jsxs(et,{open:F,onClose:()=>u(!1),fullWidth:!0,maxWidth:"sm",children:[t.jsx(it,{children:p?"Edit Binding":"Add Binding"}),t.jsx(st,{children:t.jsxs(L,{spacing:2,mt:1,children:[t.jsx(l,{label:"Name",value:i.name,onChange:e=>a({...i,name:e.target.value}),fullWidth:!0}),t.jsx(l,{label:"Alias",value:i.alias,onChange:e=>a({...i,alias:e.target.value}),fullWidth:!0}),t.jsx(l,{label:"Group ID",value:i.groupid,onChange:e=>a({...i,groupid:e.target.value}),fullWidth:!0}),t.jsx(l,{label:"Host ID",value:i.hostid,onChange:e=>a({...i,hostid:e.target.value}),fullWidth:!0}),t.jsx(l,{label:"Tags",value:i.tags,onChange:e=>a({...i,tags:e.target.value}),fullWidth:!0}),t.jsx(l,{label:"Description",value:i.description,onChange:e=>a({...i,description:e.target.value}),fullWidth:!0,multiline:!0,minRows:2}),t.jsx(rt,{control:t.jsx(at,{checked:!!i.enabled,onChange:e=>a({...i,enabled:e.target.checked})}),label:"Enabled"})]})}),t.jsxs(ot,{children:[t.jsx(b,{onClick:()=>u(!1),children:"Cancel"}),t.jsx(b,{variant:"contained",onClick:N,children:H?t.jsx(P,{size:18}):"Save"})]})]})]})})]})}export{oe as default};
