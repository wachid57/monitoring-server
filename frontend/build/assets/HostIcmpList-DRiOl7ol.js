import{r as a,j as e,B as x,A as j,z as g,C as b}from"./index-CJWZi9CB.js";import{D as U,X as $,_ as Y,b as Z,z as q}from"./index.esm-CBP19pFL.js";import{P as G}from"./PageContainer-BR_WMDrZ.js";import{B as Q}from"./Breadcrumb-DR6zDa-i.js";import{C as V}from"./Card-BdzGKbvD.js";import{C as ee}from"./CardContent-B4ITIunY.js";import{S as _}from"./Stack-C8hAk-Ua.js";import{B as k}from"./Box-B21Vn3Wr.js";import{T as c}from"./TextField-ZPSYDyyk.js";import{I as te}from"./InputAdornment-DP5E7Axe.js";import{B as m}from"./Button-BH1WbAiu.js";import{A as se}from"./Alert-NqiMgJWO.js";import{C as z}from"./CircularProgress-DjzG6_YG.js";import{T as oe}from"./TableContainer-C29JBPns.js";import{P as re}from"./Paper-Dk0UhltF.js";import{T as ae,d as ie,b as S,c as o,a as ne}from"./TableRow-BlqcCBcb.js";import{I as w}from"./IconButton-Cf6Oa_Gi.js";import{a as B,b as F}from"./DialogContent-iZlfiihu.js";import{D as W}from"./DialogTitle-fL9kXoX8.js";import{T as le}from"./Typography-DW8TAfFy.js";import{D as M}from"./DialogActions-WyzZcgZE.js";import"./Grid2-TKUllLdh.js";import"./composeClasses-CkcSq-l_.js";import"./index-BwqtTtay.js";import"./useSlotProps-Dmx4i6VU.js";import"./Link-DrUusogV.js";import"./createStack-B05ZxkoV.js";import"./useSlot-BJnJs1tW.js";import"./FormControl-CoJ51_a0.js";import"./utils-DoM3o7-Q.js";import"./useFormControl-D8zMB56u.js";import"./isMuiElement-DUOjtQlD.js";import"./useId-5Do1p0JB.js";import"./formControlState-Dq1zat_P.js";import"./Select-BdS4d3Pw.js";import"./Popover-C4QiusQk.js";import"./isHostComponent-DVu5iVWx.js";import"./Modal-BmV9fUd8.js";import"./getReactNodeRef-CxaND9dZ.js";import"./ownerWindow-CPegdbNg.js";import"./createChainedFunction-BO_9K8Jh.js";import"./utils-C-EoFTAL.js";import"./Portal-BXG2mGLy.js";import"./debounce-Be36O1Ab.js";import"./Grow-rhCcvyQJ.js";import"./List-CPHbMiuQ.js";import"./useControlled-Cuh16IWT.js";import"./resolveProps-CxWqPvcr.js";import"./Close-4pq8Nglm.js";const ce=[{to:"/",title:"Home"},{title:"Monitoring"},{title:"ICMP Hosts"}],at=()=>{var L;const[N,T]=a.useState([]),[O,D]=a.useState(!1),[H,i]=a.useState(""),[p,R]=a.useState(""),[C,u]=a.useState({open:!1,host:null}),[X,d]=a.useState(!1),[r,n]=a.useState({ip:"",hostname:"",alias:"",service:"",hosts_tags:""}),[h,v]=a.useState(!1),[A,y]=a.useState(null),[J,I]=a.useState(!1),P=async()=>{D(!0),i("");try{const t=await fetch(x+j+"/hosts",{headers:g()});if(t.status===401||t.status===403){b({status:t.status});return}const s=await t.json();t.ok?T(s||[]):i(s.error||"Failed to fetch hosts")}catch(t){console.error("fetch hosts error",t),i("Failed to fetch hosts")}finally{D(!1)}},K=async t=>{try{const s=await fetch(x+j+`/hosts/${t}`,{method:"DELETE",headers:g()});if(s.status===401||s.status===403)return b({status:s.status});if(s.ok)T(l=>l.filter(f=>f.id!==t)),u({open:!1,host:null});else{const l=await s.json();i(l.error||"Failed to delete host")}}catch(s){console.error("delete host error",s),i("Failed to delete host")}},E=N.filter(t=>{var s,l,f;return((s=t.hostname)==null?void 0:s.toLowerCase().includes(p.toLowerCase()))||((l=t.ip)==null?void 0:l.toLowerCase().includes(p.toLowerCase()))||((f=t.alias)==null?void 0:f.toLowerCase().includes(p.toLowerCase()))});return a.useEffect(()=>{P()},[]),e.jsxs(G,{title:"ICMP Hosts",description:"ICMP-monitored hosts",children:[e.jsx(Q,{title:"ICMP Hosts",items:ce}),e.jsx(V,{children:e.jsxs(ee,{children:[e.jsxs(_,{direction:"row",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsx(k,{sx:{minWidth:300},children:e.jsx(c,{placeholder:"Search hosts...",value:p,onChange:t=>R(t.target.value),InputProps:{startAdornment:e.jsx(te,{position:"start",children:e.jsx(U,{size:20})})},fullWidth:!0})}),e.jsx(m,{variant:"contained",startIcon:e.jsx($,{}),onClick:()=>d(!0),sx:{width:225},children:"Add Host"})]}),H&&e.jsx(se,{severity:"error",sx:{mb:3},children:H}),O?e.jsx(k,{display:"flex",justifyContent:"center",py:4,children:e.jsx(z,{})}):e.jsx(oe,{component:re,children:e.jsxs(ae,{children:[e.jsx(ie,{children:e.jsxs(S,{children:[e.jsx(o,{children:"IP"}),e.jsx(o,{children:"Hostname"}),e.jsx(o,{children:"Alias"}),e.jsx(o,{children:"Service"}),e.jsx(o,{children:"Tags"}),e.jsx(o,{children:"Created"}),e.jsx(o,{align:"center",children:"Actions"})]})}),e.jsx(ne,{children:E.length===0?e.jsx(S,{children:e.jsx(o,{colSpan:7,align:"center",children:"No hosts found"})}):E.map(t=>e.jsxs(S,{children:[e.jsx(o,{children:t.ip||"-"}),e.jsx(o,{children:t.hostname||"-"}),e.jsx(o,{children:t.alias||"-"}),e.jsx(o,{children:t.service||"-"}),e.jsx(o,{children:t.hosts_tags||"-"}),e.jsx(o,{children:t.created_at?new Date(t.created_at).toLocaleDateString():"-"}),e.jsx(o,{align:"center",children:e.jsxs(_,{direction:"row",spacing:1,justifyContent:"center",children:[e.jsx(w,{size:"small",color:"primary",children:e.jsx(Y,{size:16})}),e.jsx(w,{size:"small",color:"warning",onClick:()=>{v(!0),y(t.id),n({ip:t.ip||"",hostname:t.hostname||"",alias:t.alias||"",service:t.service||"",hosts_tags:t.hosts_tags||""}),d(!0)},children:e.jsx(Z,{size:16})}),e.jsx(w,{size:"small",color:"error",onClick:()=>u({open:!0,host:t}),children:e.jsx(q,{size:16})})]})})]},t.id))})]})})]})}),e.jsxs(B,{open:C.open,onClose:()=>u({open:!1,host:null}),children:[e.jsx(W,{children:"Confirm Delete"}),e.jsx(F,{children:e.jsxs(le,{children:['Delete host "',(L=C.host)==null?void 0:L.hostname,'"?']})}),e.jsxs(M,{children:[e.jsx(m,{onClick:()=>u({open:!1,host:null}),children:"Cancel"}),e.jsx(m,{color:"error",variant:"contained",onClick:()=>{var t;return K((t=C.host)==null?void 0:t.id)},children:"Delete"})]})]}),e.jsxs(B,{open:X,onClose:()=>{d(!1),v(!1),y(null)},fullWidth:!0,maxWidth:"sm",children:[e.jsx(W,{children:h?"Edit Host":"Add Host"}),e.jsxs(F,{children:[e.jsx(c,{label:"IP",fullWidth:!0,margin:"dense",value:r.ip,onChange:t=>n({...r,ip:t.target.value})}),e.jsx(c,{label:"Hostname",fullWidth:!0,margin:"dense",value:r.hostname,onChange:t=>n({...r,hostname:t.target.value})}),e.jsx(c,{label:"Alias",fullWidth:!0,margin:"dense",value:r.alias,onChange:t=>n({...r,alias:t.target.value})}),e.jsx(c,{label:"Service",fullWidth:!0,margin:"dense",value:r.service,onChange:t=>n({...r,service:t.target.value})}),e.jsx(c,{label:"Tags",fullWidth:!0,margin:"dense",value:r.hosts_tags,onChange:t=>n({...r,hosts_tags:t.target.value})})]}),e.jsxs(M,{children:[e.jsx(m,{onClick:()=>d(!1),children:"Cancel"}),e.jsx(m,{variant:"contained",color:"primary",onClick:async()=>{I(!0);try{let t;if(h&&A?t=await fetch(x+j+`/hosts/${A}`,{method:"PUT",headers:{"Content-Type":"application/json",...g()},body:JSON.stringify(r)}):t=await fetch(x+j+"/hosts",{method:"POST",headers:{"Content-Type":"application/json",...g()},body:JSON.stringify(r)}),t.status===401||t.status===403)return b({status:t.status});const s=await t.json();t.ok?(P(),d(!1),n({ip:"",hostname:"",alias:"",service:"",hosts_tags:""}),v(!1),y(null)):i(s.error||(h?"Failed to update host":"Failed to create host"))}catch(t){console.error(t),i(h?"Failed to update host":"Failed to create host")}finally{I(!1)}},children:J?e.jsx(z,{size:20}):h?"Save":"Create"})]})]})]})};export{at as default};
