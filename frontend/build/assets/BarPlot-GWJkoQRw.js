import{g as V,s as N,v as I,_ as p,a as z,h as q,u as nt}from"./Typography-DW8TAfFy.js";import{j as g,r as J}from"./index-CJWZi9CB.js";import{d as U,e as rt,f as lt,g as T,i as W,h as ct,j as dt,k as ut}from"./ChartsAxisHighlight-YKpwFUDQ.js";import{u as Q,a as ht}from"./useChartId-D6IeINbA.js";import{u as Z}from"./useSlotProps-Dmx4i6VU.js";import{n as mt,o as ft,b as xt}from"./useChartContainerDimensions-CjTkzPDm.js";import{u as gt}from"./useSkipAnimation-BL3iWm-Y.js";const yt=["id","dataIndex","classes","color","slots","slotProps","style","onClick"];function bt(t){return q("MuiBarElement",t)}V("MuiBarElement",["root"]);const pt=t=>{const{classes:e,id:a}=t,s={root:["root",`series-${a}`]};return z(s,bt,e)},kt=N(U.rect,{name:"MuiBarElement",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>({stroke:"none",fill:t.isHighlighted?rt(t.color).brighter(.5).formatHex():t.color,transition:"opacity 0.2s ease-in, fill 0.2s ease-in",opacity:t.isFaded&&.3||1}));function $t(t){const{id:e,dataIndex:a,classes:s,color:i,slots:o,slotProps:n,style:u,onClick:l}=t,h=I(t,yt),y=lt(),{isFaded:m,isHighlighted:c}=Q({seriesId:e,dataIndex:a}),x={id:e,dataIndex:a,classes:s,color:i,isFaded:m,isHighlighted:c},k=pt(x),r=(o==null?void 0:o.bar)??kt,b=Z({elementType:r,externalSlotProps:n==null?void 0:n.bar,externalForwardedProps:h,additionalProps:p({},y({type:"bar",seriesId:e,dataIndex:a}),{style:u,onClick:l,cursor:l?"pointer":"unset"}),className:k.root,ownerState:x});return g.jsx(r,p({},b))}const _=(t,{hasNegative:e,hasPositive:a,borderRadius:s,layout:i})=>{if(!s)return 0;const o=i==="vertical";return t==="top-left"&&(o&&a||!o&&e)||t==="top-right"&&(o&&a||!o&&a)||t==="bottom-right"&&(o&&e||!o&&a)||t==="bottom-left"&&(o&&e||!o&&e)?s:0},Ct=["style","maskId"],At=t=>`inset(0px round ${t.topLeft}px ${t.topRight}px ${t.bottomRight}px ${t.bottomLeft}px)`;function It(t){var a,s;const e=t.ownerState;return g.jsx(U.rect,{style:p({},t.style,{clipPath:(t.ownerState.layout==="vertical"?(a=t.style)==null?void 0:a.height:(s=t.style)==null?void 0:s.width).to(i=>At({topLeft:Math.min(i,_("top-left",e)),topRight:Math.min(i,_("top-right",e)),bottomRight:Math.min(i,_("bottom-right",e)),bottomLeft:Math.min(i,_("bottom-left",e))}))})})}function wt(t){const{style:e,maskId:a}=t,s=I(t,Ct);return!t.borderRadius||t.borderRadius<=0?null:g.jsx("clipPath",{id:a,children:g.jsx(It,{ownerState:s,style:e})})}function Bt(t){return q("MuiBarLabel",t)}const R=V("MuiBarLabel",["root","highlighted","faded"]),St=t=>{const{classes:e,seriesId:a,isFaded:s,isHighlighted:i}=t,o={root:["root",`series-${a}`,i&&"highlighted",s&&"faded"]};return z(o,Bt,e)},Lt=t=>{const{barLabel:e,value:a,dataIndex:s,seriesId:i,height:o,width:n}=t;return e==="value"?a?a==null?void 0:a.toString():null:e({seriesId:i,dataIndex:s,value:a},{bar:{height:o,width:n}})},Mt=["seriesId","dataIndex","color","isFaded","isHighlighted","classes"],Pt=N(U.text,{name:"MuiBarLabel",slot:"Root",overridesResolver:(t,e)=>[{[`&.${R.faded}`]:e.faded},{[`&.${R.highlighted}`]:e.highlighted},e.root]})(({theme:t})=>{var e,a,s,i;return p({},(e=t==null?void 0:t.typography)==null?void 0:e.body2,{stroke:"none",fill:(i=(s=(a=t.vars||t)==null?void 0:a.palette)==null?void 0:s.text)==null?void 0:i.primary,transition:"opacity 0.2s ease-in, fill 0.2s ease-in",textAnchor:"middle",dominantBaseline:"central",pointerEvents:"none",opacity:1,[`&.${R.faded}`]:{opacity:.3}})});function _t(t){const e=nt({props:t,name:"MuiBarLabel"}),a=I(e,Mt);return g.jsx(Pt,p({},a))}const vt=["seriesId","classes","color","style","dataIndex","barLabel","slots","slotProps","height","width","value"],jt=["ownerState"];function Et(t){const{seriesId:e,classes:a,color:s,style:i,dataIndex:o,barLabel:n,slots:u,slotProps:l,height:h,width:y,value:m}=t,c=I(t,vt),{isFaded:x,isHighlighted:k}=Q({seriesId:e,dataIndex:o}),r={seriesId:e,classes:a,color:s,isFaded:x,isHighlighted:k,dataIndex:o},b=St(r),$=(u==null?void 0:u.barLabel)??_t,A=Z({elementType:$,externalSlotProps:l==null?void 0:l.barLabel,additionalProps:p({},c,{style:i,className:b.root}),ownerState:r}),{ownerState:S}=A,C=I(A,jt);if(!n)return null;const B=Lt({barLabel:n,value:m,dataIndex:o,seriesId:e,height:h,width:y});return B?g.jsx($,p({},C,S,{children:B})):null}const Rt=["bars","skipAnimation"],Dt=({layout:t,yOrigin:e,x:a,width:s,y:i,xOrigin:o,height:n})=>p({},t==="vertical"?{y:e,x:a+s/2,height:0,width:s}:{y:i+n/2,x:o,height:n,width:0}),Y=({x:t,width:e,y:a,height:s})=>({x:t+e/2,y:a+s/2,height:s,width:e});function Tt(t){const{bars:e,skipAnimation:a}=t,s=I(t,Rt),i=T(e,{keys:o=>`${o.seriesId}-${o.dataIndex}`,from:Dt,leave:null,enter:Y,update:Y,immediate:a});return g.jsx(J.Fragment,{children:i((o,{seriesId:n,dataIndex:u,color:l,value:h,width:y,height:m})=>g.jsx(Et,p({seriesId:n,dataIndex:u,value:h,color:l,width:y,height:m},s,{style:o})))})}const D=(t,e)=>{const a=`${t}-axis`,s=`${t}Axis`;return e===(t==="x"?mt:ft)?`The first \`${s}\``:`The ${a} with id "${e}"`};function Ut(t,e,a,s,i,o){const n=s[a],u=o[i],l=t?n:u,h=t?u:n,y=t?a:i,m=t?i:a,c=t?"x":"y",x=t?"y":"x";if(!W(l))throw new Error(`MUI X: ${D(c,y)} should be of type "band" to display the bar series of id "${e}".`);if(l.data===void 0)throw new Error(`MUI X: ${D(c,y)} should have data property.`);if(W(h)||ct(h))throw new Error(`MUI X: ${D(x,m)} should be a continuous type to display the bar series of id "${e}".`)}const Ft=["skipAnimation","onItemClick","borderRadius","barLabel"];function Ot({bandWidth:t,numberOfGroups:e,gapRatio:a}){if(a===0)return{barWidth:t/e,offset:0};const s=t/(e+(e-1)*a),i=a*s;return{barWidth:s,offset:i}}const Ht=()=>{const t=dt()??{series:{},stackingGroups:[],seriesOrder:[]},e=xt(),a=ht(),{series:s,stackingGroups:i}=t,{xAxis:o,yAxis:n,xAxisIds:u,yAxisIds:l}=e,h=u[0],y=l[0],m={};return{completedData:i.flatMap(({ids:x},k)=>x.flatMap(r=>{const b=s[r].xAxisId??s[r].xAxisKey??h,$=s[r].yAxisId??s[r].yAxisKey??y,A=o[b],S=n[$],C=s[r].layout==="vertical";Ut(C,r,b,o,$,n);const B=C?A:S,L=A.scale,M=S.scale,tt=ut(s[r],o[b],n[$]),et=B.scale.bandwidth(),{barWidth:E,offset:st}=Ot({bandWidth:et,numberOfGroups:i.length,gapRatio:B.barGapRatio}),F=k*(E+st),{stackedData:at}=s[r];return at.map((ot,w)=>{var X,G;const O=ot.map(K=>C?M(K):L(K)),P=Math.round(Math.min(...O)),H=Math.round(Math.max(...O)),it=s[r].stack,d={seriesId:r,dataIndex:w,layout:s[r].layout,x:C?L((X=o[b].data)==null?void 0:X[w])+F:P,y:C?P:M((G=n[$].data)==null?void 0:G[w])+F,xOrigin:L(0),yOrigin:M(0),height:C?H-P:E,width:C?E:H-P,color:tt(w),value:s[r].data[w],maskId:`${a}_${it||r}_${k}_${w}`};m[d.maskId]||(m[d.maskId]={id:d.maskId,width:0,height:0,hasNegative:!1,hasPositive:!1,layout:d.layout,xOrigin:L(0),yOrigin:M(0),x:0,y:0});const f=m[d.maskId];return f.width=d.layout==="vertical"?d.width:f.width+d.width,f.height=d.layout==="vertical"?f.height+d.height:d.height,f.x=Math.min(f.x===0?1/0:f.x,d.x),f.y=Math.min(f.y===0?1/0:f.y,d.y),f.hasNegative=f.hasNegative||(d.value??0)<0,f.hasPositive=f.hasPositive||(d.value??0)>0,d})})),masksData:Object.values(m)}},v=({layout:t,yOrigin:e,x:a,width:s,y:i,xOrigin:o,height:n})=>p({},t==="vertical"?{y:e,x:a,height:0,width:s}:{y:i,x:o,height:n,width:0}),j=({x:t,width:e,y:a,height:s})=>({y:a,x:t,height:s,width:e});function zt(t){const{completedData:e,masksData:a}=Ht(),{skipAnimation:s,onItemClick:i,borderRadius:o,barLabel:n}=t,u=I(t,Ft),l=gt(s),h=!o||o<=0,y=T(e,{keys:c=>`${c.seriesId}-${c.dataIndex}`,from:v,leave:v,enter:j,update:j,immediate:l}),m=T(h?[]:a,{keys:c=>c.id,from:v,leave:v,enter:j,update:j,immediate:l});return g.jsxs(J.Fragment,{children:[!h&&m((c,{id:x,hasPositive:k,hasNegative:r,layout:b})=>g.jsx(wt,{maskId:x,borderRadius:o,hasNegative:r,hasPositive:k,layout:b,style:c})),y((c,{seriesId:x,dataIndex:k,color:r,maskId:b})=>{const $=g.jsx($t,p({id:x,dataIndex:k,color:r},u,{onClick:i&&(A=>{i(A,{type:"bar",seriesId:x,dataIndex:k})}),style:c}));return h?$:g.jsx("g",{clipPath:`url(#${b})`,children:$})}),n&&g.jsx(Tt,p({bars:e,skipAnimation:l,barLabel:n},u))]})}export{zt as B};
